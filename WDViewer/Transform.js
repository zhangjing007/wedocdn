!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var o in i)("object"==typeof exports?exports:e)[o]=i[o]}}(self,(function(){return(()=>{var e,t,i,o={52655:(e,t,i)=>{(t=i(23645)(!1)).push([e.id,"#toolbar-transformSubMenu .wedofont {\n  font-size: 24px !important;\n}\n",""]),e.exports=t},70228:()=>{!function(){"use strict";var e=function(e){THREE.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=THREE.FrontSide,this.transparent=!0,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};e.prototype=Object.create(THREE.MeshBasicMaterial.prototype);var t=function(e){THREE.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=3,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};t.prototype=Object.create(THREE.LineBasicMaterial.prototype),void 0===THREE.PolyhedronGeometry&&(THREE.PolyhedronGeometry=function(e,t,i,o){THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:o},i=i||1,o=o||0;for(var r=this,n=0,s=e.length;n<s;n+=3)w(new THREE.Vector3(e[n],e[n+1],e[n+2]));var a=this.vertices,l=[],c=(n=0,0);for(s=t.length;n<s;n+=3,c++){var h=a[t[n]],d=a[t[n+1]],p=a[t[n+2]];l[c]=new THREE.Face3(h.index,d.index,p.index,[h.clone(),d.clone(),p.clone()])}var E=new THREE.Vector3;for(n=0,s=l.length;n<s;n++)R(l[n],o);for(n=0,s=this.faceVertexUvs[0].length;n<s;n++){var u=this.faceVertexUvs[0][n],m=u[0].x,v=u[1].x,f=u[2].x,y=Math.max(m,Math.max(v,f)),T=Math.min(m,Math.min(v,f));y>.9&&T<.1&&(m<.2&&(u[0].x+=1),v<.2&&(u[1].x+=1),f<.2&&(u[2].x+=1))}for(n=0,s=this.vertices.length;n<s;n++)this.vertices[n].multiplyScalar(i);function w(e){var t=e.normalize().clone();t.index=r.vertices.push(t)-1;var i=x(e)/2/Math.PI+.5,o=function(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(e)/Math.PI+.5;return t.uv=new THREE.Vector2(i,1-o),t}function g(e,t,i){var o=new THREE.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()]);r.faces.push(o),E.copy(e).add(t).add(i).divideScalar(3);var n=x(E);r.faceVertexUvs[0].push([M(e.uv,e,n),M(t.uv,t,n),M(i.uv,i,n)])}function R(e,t){for(var i=Math.pow(2,t),o=(Math.pow(4,t),w(r.vertices[e.a])),n=w(r.vertices[e.b]),s=w(r.vertices[e.c]),a=[],l=0;l<=i;l++){a[l]=[];for(var c=w(o.clone().lerp(s,l/i)),h=w(n.clone().lerp(s,l/i)),d=i-l,p=0;p<=d;p++)a[l][p]=0==p&&l==i?c:w(c.clone().lerp(h,p/d))}for(l=0;l<i;l++)for(p=0;p<2*(i-l)-1;p++){var E=Math.floor(p/2);p%2==0?g(a[l][E+1],a[l+1][E],a[l][E]):g(a[l][E+1],a[l+1][E+1],a[l+1][E])}}function x(e){return Math.atan2(e.z,-e.x)}function M(e,t,i){return i<0&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(i/2/Math.PI+.5,e.y)),e.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype)),void 0===THREE.OctahedronGeometry&&(THREE.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t},THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype)),void 0===THREE.TorusGeometry&&(THREE.TorusGeometry=function(e,t,i,o,r){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:o,arc:r},e=e||100,t=t||40,i=i||8,o=o||6,r=r||2*Math.PI;for(var n=new THREE.Vector3,s=[],a=[],l=0;l<=i;l++)for(var c=0;c<=o;c++){var h=c/o*r,d=l/i*Math.PI*2;n.x=e*Math.cos(h),n.y=e*Math.sin(h);var p=new THREE.Vector3;p.x=(e+t*Math.cos(d))*Math.cos(h),p.y=(e+t*Math.cos(d))*Math.sin(h),p.z=t*Math.sin(d),this.vertices.push(p),s.push(new THREE.Vector2(c/o,l/i)),a.push(p.clone().sub(n).normalize())}for(l=1;l<=i;l++)for(c=1;c<=o;c++){var E=(o+1)*l+c-1,u=(o+1)*(l-1)+c-1,m=(o+1)*(l-1)+c,v=(o+1)*l+c,f=new THREE.Face3(E,u,v,[a[E].clone(),a[u].clone(),a[v].clone()]);this.faces.push(f),this.faceVertexUvs[0].push([s[E].clone(),s[u].clone(),s[v].clone()]),f=new THREE.Face3(u,m,v,[a[u].clone(),a[m].clone(),a[v].clone()]),this.faces.push(f),this.faceVertexUvs[0].push([s[u].clone(),s[m].clone(),s[v].clone()])}this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype));var i=function(e,t,i){var o=new THREE.Geometry;i=i||1;for(var r=0;r<=64*i;++r)"x"==t&&o.vertices.push(new THREE.Vector3(0,Math.cos(r/32*Math.PI),Math.sin(r/32*Math.PI)).multiplyScalar(e)),"y"==t&&o.vertices.push(new THREE.Vector3(Math.cos(r/32*Math.PI),0,Math.sin(r/32*Math.PI)).multiplyScalar(e)),"z"==t&&o.vertices.push(new THREE.Vector3(Math.sin(r/32*Math.PI),Math.cos(r/32*Math.PI),0).multiplyScalar(e));return o},o=function(e,t,i,o,r,n){var s=new THREE.Geometry,a=new THREE.Mesh(new THREE.CylinderGeometry(e,t,i,o,r,n));return a.position.y=.5,a.updateMatrix(),s.merge(a.geometry,a.matrix),s},r=function(e){var t=new THREE.Geometry;return"X"===e?t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0)):"Y"===e?t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0)):"Z"===e&&t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),t};THREE.TransformGizmo=function(){var e=this;this.init=function(){THREE.Object3D.call(this),this.handles=new THREE.Object3D,this.pickers=new THREE.Object3D,this.planes=new THREE.Object3D,this.highlights=new THREE.Object3D,this.hemiPicker=new THREE.Object3D,this.subPickers=new THREE.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes),this.add(this.highlights),this.add(this.hemiPicker),this.add(this.subPickers);var e=new THREE.PlaneBufferGeometry(50,50,2,2),t=new THREE.MeshBasicMaterial({wireframe:!0});t.side=THREE.DoubleSide;var i={XY:new THREE.Mesh(e,t),YZ:new THREE.Mesh(e,t),XZ:new THREE.Mesh(e,t),XYZE:new THREE.Mesh(e,t)};for(var o in this.activePlane=i.XYZE,i.YZ.rotation.set(0,Math.PI/2,0),i.XZ.rotation.set(-Math.PI/2,0,0),i)i[o].name=o,this.planes.add(i[o]),this.planes[o]=i[o],i[o].visible=!1;this.setupGizmos(),this.activeMode="",this.traverse((function(e){if(e instanceof THREE.Mesh){e.updateMatrix();var t=new THREE.Geometry;e.geometry instanceof THREE.BufferGeometry&&(e.geometry=(new THREE.Geometry).fromBufferGeometry(e.geometry)),t.merge(e.geometry,e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}}))},this.hide=function(){this.traverse((function(e){e.visible=!1}))},this.show=function(){this.traverse((function(t){t.visible=!0,t.parent!=e.pickers&&t.parent!=e.hemiPicker||(t.visible=!1),t.parent==e.planes&&(t.visible=!1)})),this.activePlane.visible=!1},this.highlight=function(e){this.traverse((function(t){t.material&&t.material.highlight&&(t.name==e?t.material.highlight(!0):t.material.highlight(!1))}))},this.setupGizmos=function(){var e=function(e,t){for(var i in e)for(var o=e[i].length;o--;){var r=e[i][o][0],n=e[i][o][1],s=e[i][o][2],a=e[i][o][3];r.name=i,n&&r.position.set(n[0],n[1],n[2]),s&&r.rotation.set(s[0],s[1],s[2]),a&&(r.visble=a),t.add(r)}};this.setHandlePickerGizmos(),e(this.handleGizmos,this.handles),e(this.pickerGizmos,this.pickers),e(this.highlightGizmos,this.highlights),e(this.hemiPickerGizmos,this.hemiPicker),e(this.subPickerGizmos,this.subPickers),this.hide(),this.show()}},THREE.TransformGizmo.prototype=Object.create(THREE.Object3D.prototype),THREE.TransformGizmo.prototype.update=function(e,t){var i=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,1,0),r=new THREE.Matrix4;this.traverse((function(n){n.name&&(-1!=n.name.search("E")?n.quaternion.setFromRotationMatrix(r.lookAt(t,i,o)):-1==n.name.search("X")&&-1==n.name.search("Y")&&-1==n.name.search("Z")||n.quaternion.setFromEuler(e))}))},THREE.TransformGizmoTranslate=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){var i=o(0,.05,.2,12,1,!1),n=r("X"),s=r("Y"),a=r("Z");this.handleGizmos={X:[[new THREE.Mesh(i,new e({color:15805484})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(n,new t({color:15805484}))]],Y:[[new THREE.Mesh(i,new e({color:768011})),[0,.5,0]],[new THREE.Line(s,new t({color:768011}))]],Z:[[new THREE.Mesh(i,new e({color:2895089})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(a,new t({color:2895089}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new e({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new e({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new e({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new e({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),new e({color:16777215,opacity:.25}))]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new e({color:16776960,opacity:.25})),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new e({color:65535,opacity:.25})),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new e({color:16711935,opacity:.25})),[.2,0,.2],[-Math.PI/2,0,0]]]},this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(1.2,1.2,1.2),new e({color:255})),[.5,.5,.5],null,!1]]}},this.setActivePlane=function(e,t){var i=new THREE.Matrix4;t.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"==e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"==e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"==e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==e&&(this.activePlane=this.planes.XYZE),"XY"==e&&(this.activePlane=this.planes.XY),"YZ"==e&&(this.activePlane=this.planes.YZ),"XZ"==e&&(this.activePlane=this.planes.XZ),this.hide(),this.show()},this.init()},THREE.TransformGizmoTranslate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoRotate=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){this.handleGizmos={RX:[[new THREE.Line(i(1,"x",.5),new t({color:16711680}))]],RY:[[new THREE.Line(i(1,"y",.5),new t({color:65280}))]],RZ:[[new THREE.Line(i(1,"z",.5),new t({color:255}))]],RE:[[new THREE.Line(i(1.25,"z",1),new t({color:65535}))]],RXYZE:[[new THREE.Line(i(1,"z",1),new t({color:16711935}))]]},this.pickerGizmos={RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new e({color:16711680,opacity:.25})),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new e({color:65280,opacity:.25})),[0,0,0],[Math.PI/2,0,0]]],RZ:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new e({color:255,opacity:.25})),[0,0,0],[0,0,-Math.PI/2]]],RE:[[new THREE.Mesh(new THREE.TorusGeometry(1.25,.12,2,24),new e({color:65535,opacity:.25}))]],RXYZE:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,2,24),new e({color:16711935,opacity:.25}))]]}},this.setActivePlane=function(e){"RE"==e&&(this.activePlane=this.planes.XYZE),"RX"==e&&(this.activePlane=this.planes.YZ),"RY"==e&&(this.activePlane=this.planes.XZ),"RZ"==e&&(this.activePlane=this.planes.XY),this.hide(),this.show()},this.update=function(e,t){THREE.TransformGizmo.prototype.update.apply(this,arguments);var i=new THREE.Matrix4,o=new THREE.Euler(0,0,1),r=new THREE.Quaternion,n=new THREE.Vector3(1,0,0),s=new THREE.Vector3(0,1,0),a=new THREE.Vector3(0,0,1),l=new THREE.Quaternion,c=new THREE.Quaternion,h=new THREE.Quaternion,d=t.clone();o.copy(this.planes.XY.rotation),r.setFromEuler(o),i.makeRotationFromQuaternion(r).getInverse(i),d.applyMatrix4(i),this.traverse((function(e){r.setFromEuler(o),"RX"==e.name&&(l.setFromAxisAngle(n,Math.atan2(-d.y,d.z)),r.multiplyQuaternions(r,l),e.quaternion.copy(r)),"RY"==e.name&&(c.setFromAxisAngle(s,Math.atan2(d.x,d.z)),r.multiplyQuaternions(r,c),e.quaternion.copy(r)),"RZ"==e.name&&(h.setFromAxisAngle(a,Math.atan2(d.y,d.x)),r.multiplyQuaternions(r,h),e.quaternion.copy(r))}))},this.init()},THREE.TransformGizmoRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoTranslateRotate=function(){THREE.TransformGizmo.call(this);var t=this;this.setHandlePickerGizmos=function(){var t=o(0,.05,.2,12,1,!1);(new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,-.1),new THREE.Vector3(0,0,.1),new THREE.Vector3(-.1,0,0),new THREE.Vector3(.1,0,0));this.handleGizmos={Z:[[new THREE.Mesh(t,new e({color:16777215})),[0,0,.25],[Math.PI/2,0,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.015,.015,.6,4,1,!1),new e({color:16777215})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,.3*Math.PI),new e({color:16711680})),[0,0,0],[.15*Math.PI,-Math.PI/2,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.015,60,1,!1),new e({color:16711680})),[0,0,1],[Math.PI/2,0,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,.3*Math.PI),new e({color:255})),[0,0,0],[Math.PI/2,0,.35*Math.PI]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.01,60,1,!1),new e({color:255})),[0,0,1]]]},this.pickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new e({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,.3*Math.PI),new e({color:16711680,opacity:.25})),[0,0,0],[.15*Math.PI,-Math.PI/2,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,.3*Math.PI),new e({color:255,opacity:.25})),[0,0,0],[Math.PI/2,0,.35*Math.PI]]]},this.subPickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new e({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]]},this.highlightGizmos={Z:[],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new e({color:16711680,opacity:1})),[0,0,0],[0,-Math.PI/2,-Math.PI/2],!1]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new e({color:255,opacity:1})),[0,0,0],[Math.PI/2,0,0],!1]]},this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.SphereGeometry(1.2,8,8,0,Math.PI),new e({color:255})),null,null,!1]]}},this.setActivePlane=function(e,t){if("translate"==this.activeMode){var i=new THREE.Matrix4;t.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"==e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"==e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"==e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ))}else"rotate"==this.activeMode&&("RX"==e&&(this.activePlane=this.planes.YZ),"RY"==e&&(this.activePlane=this.planes.XZ),"RZ"==e&&(this.activePlane=this.planes.XY));this.hide(),this.show()},this.update=function(e,t){if("translate"==this.activeMode)THREE.TransformGizmo.prototype.update.apply(this,arguments);else if("rotate"==this.activeMode){THREE.TransformGizmo.prototype.update.apply(this,arguments);var i=new THREE.Matrix4,o=new THREE.Euler(0,0,1),r=new THREE.Quaternion,n=new THREE.Vector3(1,0,0),s=new THREE.Vector3(0,1,0),a=new THREE.Vector3(0,0,1),l=new THREE.Quaternion,c=new THREE.Quaternion,h=new THREE.Quaternion,d=t.clone();o.copy(this.planes.XY.rotation),r.setFromEuler(o),i.makeRotationFromQuaternion(r).getInverse(i),d.applyMatrix4(i),this.traverse((function(e){r.setFromEuler(o),"RX"==e.name&&(l.setFromAxisAngle(n,Math.atan2(-d.y,d.z)),r.multiplyQuaternions(r,l),e.quaternion.copy(r)),"RY"==e.name&&(c.setFromAxisAngle(s,Math.atan2(d.x,d.z)),r.multiplyQuaternions(r,c),e.quaternion.copy(r)),"RZ"==e.name&&(h.setFromAxisAngle(a,Math.atan2(d.y,d.x)),r.multiplyQuaternions(r,h),e.quaternion.copy(r))}))}},this.show=function(){this.traverse((function(e){(null==t.parent||t.parent.useAllPickers||e.parent!=t.handles)&&(e.visible=!0),e.material&&(e.material.opacity=e.material.oldOpacity),e.parent!=t.pickers&&e.parent!=t.hemiPicker&&e.parent!=t.subPickers||(e.visible=!1),e.parent!=t.planes&&e.parent!=t.highlights||(e.visible=!1)})),this.activePlane.visible=!1},this.highlight=function(e){this.traverse((function(i){i.material&&i.material.highlight&&(i.name==e?(i.parent!=t.highlights&&i.parent!=t.handles||(i.visible=!0),i.material.highlight(!0)):(i.material.highlight(!1),i.material.opacity=.1))}))},this.init()},THREE.TransformGizmoTranslateRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoScale=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){var i=o(.125,.125,.125),n=r("X"),s=r("Y"),a=r("Z");this.handleGizmos={X:[[new THREE.Mesh(i,new e({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(n,new t({color:16711680}))]],Y:[[new THREE.Mesh(i,new e({color:65280})),[0,.5,0]],[new THREE.Line(s,new t({color:65280}))]],Z:[[new THREE.Mesh(i,new e({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(a,new t({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125),new e({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.4,.4,.4),new e({color:16777215,opacity:.25}))]]}},this.setActivePlane=function(e,t){var i=new THREE.Matrix4;t.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"==e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"==e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"==e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==e&&(this.activePlane=this.planes.XYZE),this.hide(),this.show()},this.init()},THREE.TransformGizmoScale.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformControls=function(e,t,i){switch(THREE.Object3D.call(this),t=void 0!==t?t:document,this.gizmo={},i){case"translate":this.gizmo[i]=new THREE.TransformGizmoTranslate;break;case"rotate":this.gizmo[i]=new THREE.TransformGizmoRotate;break;case"transrotate":this.gizmo[i]=new THREE.TransformGizmoTranslateRotate;break;case"scale":this.gizmo[i]=new THREE.TransformGizmoScale}if(this.add(this.gizmo[i]),this.gizmo[i].hide(),this.object=void 0,this.snap=null,this.snapDelta=0,this.space="world",this.size=1,this.axis=null,this.useAllPickers=!0,this.unitX=new THREE.Vector3(1,0,0),this.unitY=new THREE.Vector3(0,1,0),this.unitZ=new THREE.Vector3(0,0,1),this.normal=new THREE.Vector3(0,0,1),"transrotate"===i){(n=new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1));var o=new THREE.LineBasicMaterial({color:0,linewidth:2,depthTest:!1});this.startLine=new THREE.Line(n,o);var r,n=new THREE.Geometry;o=new THREE.LineBasicMaterial({color:16770563,linewidth:2,depthTest:!1}),n.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),this.endLine=new THREE.Line(n,o),n=new THREE.Geometry,o=new THREE.LineDashedMaterial({color:0,linewidth:1,depthTest:!1}),n.vertices.push(new THREE.Vector3(0,-1,0),new THREE.Vector3(0,1,0)),this.centerLine=new THREE.Line(n,o),(r=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/centerMarker_X.png"))).magFilter=r.minFilter=THREE.NearestFilter,n=new THREE.CircleGeometry(.1,32),o=new THREE.MeshBasicMaterial({opacity:1,side:THREE.DoubleSide,transparent:!0,map:r}),this.centerMark=new THREE.Mesh(n,o),this.centerMark.rotation.set(Math.PI/2,0,0),this.ticks={},(r=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/cardinalPoint.png"))).magFilter=r.minFilter=THREE.NearestFilter,o=new THREE.MeshBasicMaterial({depthTest:!1,opacity:1,transparent:!0,side:THREE.DoubleSide,map:r});this.ticks.RX=new THREE.Object3D,n=new THREE.PlaneBufferGeometry(.12,.25);var s=new THREE.Mesh(n,o);s.position.set(0,0,-1.275),s.rotation.set(Math.PI/2,Math.PI/2,0),this.ticks.RX.add(s),(s=s.clone()).position.set(0,1.275,0),s.rotation.set(0,Math.PI/2,0),this.ticks.RX.add(s),(s=s.clone()).position.set(0,0,1.275),s.rotation.set(0,Math.PI/2,Math.PI/2),this.ticks.RX.add(s),(s=s.clone()).position.set(0,-1.275,0),s.rotation.set(0,Math.PI/2,0),this.ticks.RX.add(s),this.ticks.RY=new THREE.Object3D,(s=s.clone()).position.set(0,0,-1.275),s.rotation.set(Math.PI/2,0,0),this.ticks.RY.add(s),(s=s.clone()).position.set(-1.275,0,0),s.rotation.set(Math.PI/2,0,Math.PI/2),this.ticks.RY.add(s),(s=s.clone()).position.set(0,0,1.275),s.rotation.set(Math.PI/2,0,0),this.ticks.RY.add(s),(s=s.clone()).position.set(1.275,0,0),s.rotation.set(Math.PI/2,0,Math.PI/2),this.ticks.RY.add(s)}var a=this,l=!1,c=i,h={type:"change"},d={type:"mouseDown"},p={type:"mouseUp",mode:c},E={type:"objectChange"},u=new THREE.Raycaster,m=new THREE.Vector3,v=new THREE.Vector3,f=new THREE.Vector3,y=new THREE.Vector3,T=new THREE.Vector3,w=new THREE.Vector3,g=1,R=new THREE.Matrix4,x=new THREE.Vector3,M=new THREE.Matrix4,H=new THREE.Vector3,_=new THREE.Quaternion,b=new THREE.Vector3,P=new THREE.Vector3,z=new THREE.Vector3,I=new THREE.Quaternion,C=new THREE.Quaternion,G=new THREE.Quaternion,k=new THREE.Quaternion,A=new THREE.Quaternion,S=new THREE.Vector3,V=new THREE.Vector3,O=new THREE.Matrix4,j=new THREE.Matrix4,L=new THREE.Vector3,X=new THREE.Vector3,Y=new THREE.Euler,F=new THREE.Matrix4,Z=new THREE.Vector3;function D(i,o){var r=t.getBoundingClientRect(),n=(i.clientX-r.left)/r.width*2-1,s=-(i.clientY-r.top)/r.height*2+1;e.isPerspective?(m.set(n,s,.5),m.unproject(e),u.set(e.position,m.sub(e.position).normalize())):(m.set(n,s,-1),m.unproject(e),v.set(0,0,-1),u.set(m,v.transformDirection(e.matrixWorld)));var a=u.intersectObjects(o,!0);return!!a[0]&&a[0]}new THREE.Euler,this.attach=function(e){a.object=e,this.gizmo[c].show(),a.update(),a.updateUnitVectors()},this.detach=function(e){a.object=void 0,this.axis=null,this.gizmo[c].hide()},this.setMode=function(e){"scale"==(c=e||c)&&(a.space="local"),this.gizmo[c].show(),this.update(),a.dispatchEvent(h)},this.getPicker=function(){return a.gizmo[c].hemiPicker.children},this.setPosition=function(e){this.object.position.copy(e),this.update()},this.setNormal=function(e){_.setFromUnitVectors(this.normal,e),this.unitX.applyQuaternion(_),this.unitY.applyQuaternion(_),this.unitZ.applyQuaternion(_),this.normal.copy(e),this.object&&this.object.quaternion.multiply(_),this.update()},this.setSnap=function(e,t){a.snap=e,a.snapDelta=t},this.setSize=function(e){a.size=e,this.update(),a.dispatchEvent(h)},this.setSpace=function(e){a.space=e,this.update(),a.dispatchEvent(h)},this.update=function(i){if(void 0!==a.object){a.object.updateMatrixWorld(),X.setFromMatrixPosition(a.object.matrixWorld),Y.setFromRotationMatrix(M.extractRotation(a.object.matrixWorld)),e.updateMatrixWorld(),Z.setFromMatrixPosition(e.matrixWorld),this.position.copy(X),this.quaternion.setFromEuler(Y),this.normal.set(0,0,1),this.normal.applyEuler(Y);var o=X.distanceTo(Z),r=e.isPerspective?2*Math.tan(e.fov*Math.PI/360)*o:o,n=t.getBoundingClientRect();g=100*r/n.height,this.scale.set(g,g,g),i&&this.gizmo[c].highlight(a.axis)}},this.updateUnitVectors=function(){this.unitX.set(1,0,0),this.unitY.set(0,1,0),this.unitZ.set(0,0,1),this.unitX.applyEuler(Y),this.unitY.applyEuler(Y),this.unitZ.applyEuler(Y)},this.showRotationGizmos=function(e){for(var t=this.gizmo[c].handles.children,i=0;i<t.length;i++){var o=t[i];o.visible=!0,-1!==o.name.search("R")&&(o.visible=e)}this.useAllPickers=e},this.highlight=function(){this.gizmo[c].highlight(this.axis||"Z")},this.onPointerHover=function(e){if(void 0===a.object||!0===l)return!1;var t=D(e.pointers?e.pointers[0]:e,a.useAllPickers?a.gizmo[c].pickers.children:a.gizmo[c].subPickers.children),i=null,o="";return t&&(o=-1!=(i=t.object.name).search("R")?"rotate":"translate"),a.axis!==i&&(a.axis=i,a.gizmo[c].activeMode=o,a.update(!0),a.dispatchEvent(h)),null===a.axis&&a.gizmo[c].show(),!!t},this.onPointerDown=function(t){if(void 0===a.object||!0===l)return!1;var i=t.pointers?t.pointers[0]:t;if("touch"===t.pointerType){var o=null,r="";(n=D(i,a.useAllPickers?a.gizmo[c].pickers.children:a.gizmo[c].subPickers.children))&&(r=-1!=(o=n.object.name).search("R")?"rotate":"translate"),a.axis!==o&&(a.axis=o,a.gizmo[c].activeMode=r)}var n=null;if((0===i.button||void 0===i.button)&&(n=D(i,a.useAllPickers?a.gizmo[c].pickers.children:a.gizmo[c].subPickers.children))){a.dispatchEvent(d),a.axis=n.object.name,a.update(),x.copy(e.position).sub(X).normalize(),a.gizmo[c].setActivePlane(a.axis,x);var s=D(i,[a.gizmo[c].activePlane]);if(s&&y.copy(s.point),S.copy(a.object.position),V.copy(a.object.scale),O.extractRotation(a.object.matrix),F.extractRotation(a.object.matrixWorld),a.object.parent?(j.extractRotation(a.object.parent.matrixWorld),L.setFromMatrixScale(M.getInverse(a.object.parent.matrixWorld))):(j.extractRotation(a.object.matrixWorld),L.setFromMatrixScale(M.getInverse(a.object.matrixWorld))),"transrotate"===c&&"rotate"===a.gizmo[c].activeMode){a.startLine.geometry.vertices[0].set(0,0,0).applyMatrix4(a.matrixWorld),a.startLine.geometry.vertices[1].set(0,0,1).applyMatrix4(a.matrixWorld),a.startLine.geometry.verticesNeedUpdate=!0,a.parent.add(a.startLine);var h=a.object.geometry.getAttribute("position"),p=(new THREE.Vector3).fromAttribute(h,0).applyMatrix4(a.object.matrixWorld),E=(new THREE.Vector3).fromAttribute(h,1).applyMatrix4(a.object.matrixWorld),u=(new THREE.Vector3).fromAttribute(h,2).applyMatrix4(a.object.matrixWorld),m=(new THREE.Vector3).fromAttribute(h,3).applyMatrix4(a.object.matrixWorld);if("RX"===a.axis){p.lerp(u,.5),E.lerp(m,.5);var v=p.distanceTo(E);a.centerLine.material.dashSize=v/15,a.centerLine.material.gapSize=v/30,a.centerLine.geometry.vertices[0].copy(p),a.centerLine.geometry.vertices[1].copy(E)}else p.lerp(E,.5),u.lerp(m,.5),v=p.distanceTo(u),a.centerLine.material.dashSize=v/15,a.centerLine.material.gapSize=v/30,a.centerLine.geometry.vertices[0].copy(p),a.centerLine.geometry.vertices[1].copy(u);a.centerLine.geometry.computeLineDistances(),a.centerLine.geometry.verticesNeedUpdate=!0,a.parent.add(a.centerLine),a.ticks[a.axis].position.copy(a.position),a.ticks[a.axis].quaternion.copy(a.quaternion),a.ticks[a.axis].scale.copy(a.scale),a.parent.add(a.ticks[a.axis])}}return l=!0,!!n},this.onPointerMove=function(e){if(void 0===a.object||null===a.axis||!1===l)return!1;var t=D(e.pointers?e.pointers[0]:e,[a.gizmo[c].activePlane]);t&&f.copy(t.point);var i=a.gizmo[c].activeMode;if("translate"==i)f.sub(y),f.multiply(L),"local"==a.space&&(f.applyMatrix4(M.getInverse(F)),b.copy(this.unitX),P.copy(this.unitY),z.copy(this.unitZ),H.set(0,0,0),-1!=a.axis.search("X")&&(b.multiplyScalar(f.dot(this.unitX)),H.add(b)),-1!=a.axis.search("Y")&&(P.multiplyScalar(f.dot(this.unitY)),H.add(P)),-1!=a.axis.search("Z")&&(z.multiplyScalar(f.dot(this.unitZ)),H.add(z)),f.copy(H),f.applyMatrix4(O),a.object.position.copy(S),a.object.position.add(f)),"world"!=a.space&&-1==a.axis.search("XYZ")||(b.copy(this.unitX),P.copy(this.unitY),z.copy(this.unitZ),H.set(0,0,0),-1!=a.axis.search("X")&&(b.multiplyScalar(f.dot(this.unitX)),H.add(b)),-1!=a.axis.search("Y")&&(P.multiplyScalar(f.dot(this.unitY)),H.add(P)),-1!=a.axis.search("Z")&&(z.multiplyScalar(f.dot(this.unitZ)),H.add(z)),f.copy(H),f.applyMatrix4(M.getInverse(j)),a.object.position.copy(S),a.object.position.add(f));else if("scale"==i)f.sub(y),f.multiply(L),"local"==a.space&&("XYZ"==a.axis?(g=1+f.y/50,a.object.scale.x=V.x*g,a.object.scale.y=V.y*g,a.object.scale.z=V.z*g):(f.applyMatrix4(M.getInverse(F)),"X"==a.axis&&(a.object.scale.x=V.x*(1+f.x/50)),"Y"==a.axis&&(a.object.scale.y=V.y*(1+f.y/50)),"Z"==a.axis&&(a.object.scale.z=V.z*(1+f.z/50))));else if("rotate"==i){if(f.sub(X),f.multiply(L),H.copy(y).sub(X),H.multiply(L),"RE"==a.axis){f.applyMatrix4(M.getInverse(R)),H.applyMatrix4(M.getInverse(R)),T.set(Math.atan2(f.z,f.y),Math.atan2(f.x,f.z),Math.atan2(f.y,f.x)),w.set(Math.atan2(H.z,H.y),Math.atan2(H.x,H.z),Math.atan2(H.y,H.x)),_.setFromRotationMatrix(M.getInverse(j));var o=T.z-w.z;if(null!==a.snap){var r=Math.round(o/a.snap)*a.snap;Math.abs(r-o)<a.snapDelta&&(o=r)}A.setFromAxisAngle(x,o),I.setFromRotationMatrix(F),_.multiplyQuaternions(_,A),_.multiplyQuaternions(_,I),a.object.quaternion.copy(_)}else if("RXYZE"==a.axis){var n=f.clone().cross(H).normalize();_.setFromRotationMatrix(M.getInverse(j));var s=-f.clone().angleTo(H);null!==a.snap&&(r=Math.round(s/a.snap)*a.snap,Math.abs(r-s)<a.snapDelta&&(s=r)),C.setFromAxisAngle(n,s),I.setFromRotationMatrix(F),_.multiplyQuaternions(_,C),_.multiplyQuaternions(_,I),a.object.quaternion.copy(_)}else if("local"==a.space){f.applyMatrix4(M.getInverse(F)),H.applyMatrix4(M.getInverse(F));var d=f.dot(this.unitX),p=f.dot(this.unitY),u=f.dot(this.unitZ),m=H.dot(this.unitX),v=H.dot(this.unitY),Y=H.dot(this.unitZ);T.set(Math.atan2(u,p),Math.atan2(d,u),Math.atan2(p,d)),w.set(Math.atan2(Y,v),Math.atan2(m,Y),Math.atan2(v,m));var Z=T.x-w.x,q=T.y-w.y;o=T.z-w.z,null!==a.snap&&(-1!=a.axis.search("X")&&(r=Math.round(Z/a.snap)*a.snap,Math.abs(r-Z)<a.snapDelta&&(Z=r)),-1!=a.axis.search("Y")&&(r=Math.round(q/a.snap)*a.snap,Math.abs(r-q)<a.snapDelta&&(q=r)),-1!=a.axis.search("Z")&&(r=Math.round(o/a.snap)*a.snap,Math.abs(r-o)<a.snapDelta&&(o=r))),C.setFromAxisAngle(this.unitX,Z),G.setFromAxisAngle(this.unitY,q),k.setFromAxisAngle(this.unitZ,o),I.setFromRotationMatrix(O),"RX"==a.axis&&I.multiplyQuaternions(I,C),"RY"==a.axis&&I.multiplyQuaternions(I,G),"RZ"==a.axis&&I.multiplyQuaternions(I,k),a.object.quaternion.copy(I)}else"world"==a.space&&(d=f.dot(this.unitX),p=f.dot(this.unitY),u=f.dot(this.unitZ),m=H.dot(this.unitX),v=H.dot(this.unitY),Y=H.dot(this.unitZ),T.set(Math.atan2(u,p),Math.atan2(d,u),Math.atan2(p,d)),w.set(Math.atan2(Y,v),Math.atan2(m,Y),Math.atan2(v,m)),_.setFromRotationMatrix(M.getInverse(j)),Z=T.x-w.x,q=T.y-w.y,o=T.z-w.z,null!==a.snap&&(-1!=a.axis.search("X")&&(r=Math.round(Z/a.snap)*a.snap,Math.abs(r-Z)<a.snapDelta&&(Z=r)),-1!=a.axis.search("Y")&&(r=Math.round(q/a.snap)*a.snap,Math.abs(r-q)<a.snapDelta&&(q=r)),-1!=a.axis.search("Z")&&(r=Math.round(o/a.snap)*a.snap,Math.abs(r-o)<a.snapDelta&&(o=r))),C.setFromAxisAngle(this.unitX,Z),G.setFromAxisAngle(this.unitY,q),k.setFromAxisAngle(this.unitZ,o),I.setFromRotationMatrix(F),"RX"==a.axis&&_.multiplyQuaternions(_,C),"RY"==a.axis&&_.multiplyQuaternions(_,G),"RZ"==a.axis&&_.multiplyQuaternions(_,k),_.multiplyQuaternions(_,I),a.object.quaternion.copy(_));"transrotate"===c&&(a.add(a.endLine),a.add(a.centerMark))}return a.object.matrixAutoUpdate=!0,a.update(!0),a.dispatchEvent(h),a.dispatchEvent(E),!!t},this.onPointerUp=function(e){return l&&null!==a.axis&&(p.mode=c,a.dispatchEvent(p)),l=!1,this.gizmo[c].show(),this.updateUnitVectors(),"transrotate"===c&&"rotate"===this.gizmo[c].activeMode&&(this.remove(this.endLine),this.remove(this.centerMark),this.parent.remove(this.centerLine),this.parent.remove(this.startLine),this.parent.remove(this.ticks[this.axis])),!1}},THREE.TransformControls.prototype=Object.create(THREE.Object3D.prototype)}()},7892:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TransformExtension:()=>p});var o=i(43884),r=i(94069);i(70228);class n extends o.Z{constructor(e){super(),this._dbIds=[],this.active=!1,this._viewer=e,this._isDragging=!1,this.fullTransform=!1,this._transformMesh=null,this._selectedFragProxyMap={},this._transformControlTx=null,this._hitPoint=new THREE.Vector3,this.onTxChange=this.onTxChange.bind(this),this.onAggregateSelectionChanged=this.onAggregateSelectionChanged.bind(this),this.onCameraChanged=this.onCameraChanged.bind(this),this._selectionMode="SELECTION_MODE_TRANSFORM",e.toolController.registerTool(this)}getNames(){return["Viewing.Tool.Translate"]}getName(){return"Viewing.Tool.Translate"}setFullTransform(e){this.fullTransform=e,this.clearSelection()}createTransformMesh(){var e=new THREE.MeshPhongMaterial({color:16711680});this._viewer.impl.matman().addMaterial("transform-tool-material",e,!0);var t=new THREE.Mesh(new THREE.SphereGeometry(1e-4,5),e);return t.position.set(0,0,0),t}onTxChange(){if(this._isDragging&&this._transformControlTx.visible){var e=new THREE.Vector3(this._transformMesh.position.x-this._selection.model.offset.x,this._transformMesh.position.y-this._selection.model.offset.y,this._transformMesh.position.z-this._selection.model.offset.z);for(var t in this._selectedFragProxyMap){var i=this._selectedFragProxyMap[t],o=new THREE.Vector3(this._transformMesh.position.x-i.offset.x,this._transformMesh.position.y-i.offset.y,this._transformMesh.position.z-i.offset.z);console.log(o),i.position=o,i.updateAnimTransform()}this.emit("translate",{fragIds:Object.keys(this._selectedFragProxyMap),model:this._selection.model,translation:e})}this._viewer.impl.sceneUpdated(!0)}onCameraChanged(){this._transformControlTx&&this._transformControlTx.update()}onAggregateSelectionChanged(e){switch(this._selectionMode){case"SELECTION_MODE_TRANSFORM":if(this._selection&&this.pointerDown)return this._selectionMode="SELECTION_MODE_RESUME_TRANSFORM",this._viewer.clearSelection(),void(this._selection.model.selector&&this._selection.model.selector.setSelection(this._dbIds));if(e.selections.length){var t=e.selections[0];this.setSelection(t)}else this.clearSelection();break;case"SELECTION_MODE_PICK":e.selections&&e.selections.length&&(this._selectionMode="SELECTION_MODE_RESUME_TRANSFORM",this._viewer.clearSelection(),this._selection.model.selector&&this._selection.model.selector.setSelection(this._dbIds),this.setPosition(this._hitPoint));break;case"SELECTION_MODE_RESUME_TRANSFORM":setTimeout((()=>{this._selectionMode="SELECTION_MODE_TRANSFORM"}),300)}}setSelection(e){if(this._selection=e,this._dbIds=this._selection.dbIdArray,this.fullTransform){this._selection.fragIdsArray=[];for(var t=this._selection.model.getFragmentList().fragments.fragId2dbId.length,i=0;i<t;++i)this._selection.fragIdsArray.push(i);this._selection.dbIdArray=[];var o=this._selection.model.getData().instanceTree.getRootId();this._selection.dbIdArray.push(o)}this.initializeSelection(this._hitPoint),this.emit("selection",e)}async initializeSelection(e){this._selectedFragProxyMap={};var t=this._selection.model.transform||{translation:{x:0,y:0,z:0}};this._selection.model.offset={x:e.x-t.translation.x,y:e.y-t.translation.y,z:e.z-t.translation.z},this._transformControlTx.visible=!0,this._transformControlTx.setPosition(e),this._transformControlTx.addEventListener("change",this.onTxChange),this._viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged);const i=this._selection.dbIdArray,o=this._selection.model;(this._selection.fragIdsArray.length?this._selection.fragIdsArray:await r.Z.getFragIds(o,i)).forEach((t=>{var i=this._viewer.impl.getFragmentProxy(this._selection.model,t);i.getAnimTransform(),i.offset={x:e.x-i.position.x,y:e.y-i.position.y,z:e.z-i.position.z},this._selectedFragProxyMap[t]=i})),this._viewer.impl.sceneUpdated(!0)}clearSelection(){this.active&&(this._transformControlTx.visible=!1,this._selectedFragProxyMap={},this._selection=null,this._dbIds=[],this._transformControlTx.removeEventListener("change",this.onTxChange),this._viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged),this._viewer.impl.sceneUpdated(!0),this.emit("selection",null))}setPosition(e){for(var t in this._transformControlTx.setPosition(e),this._selectedFragProxyMap){var i=this._selectedFragProxyMap[t],o=new THREE.Vector3(e.x-i.offset.x,e.y-i.offset.y,e.z-i.offset.z);i.position=o,i.updateAnimTransform()}var r=new THREE.Vector3(this._transformMesh.position.x-this._selection.model.offset.x,this._transformMesh.position.y-this._selection.model.offset.y,this._transformMesh.position.z-this._selection.model.offset.z);this.emit("translate",{fragIds:Object.keys(this._selectedFragProxyMap),model:this._selection.model,translation:r,dbIds:this._dbIds}),this._viewer.impl.sceneUpdated(!0)}normalize(e){var t=this._viewer.navigation.getScreenViewport();return{x:(e.x-t.left)/t.width,y:(e.y-t.top)/t.height}}getHitPoint(e){var t={x:e.clientX,y:e.clientY},i=this.normalize(t);return this._viewer.utilities.getHitPoint(i.x,i.y)}hitPoint(){return this._transformControlTx.position}setHitPoint(e){this._hitPoint.x=e.x,this._hitPoint.y=e.y,this._hitPoint.z=e.z}activate(){if(!this.active){this.active=!0,this._viewer.toolController.activateTool(this.getName());var e=this._viewer.model.getBoundingBox();this._viewer.impl.createOverlayScene("TranslateToolOverlay"),this._transformControlTx=new THREE.TransformControls(this._viewer.impl.camera,this._viewer.impl.canvas,"translate"),this._transformControlTx.setSize(5*e.getBoundingSphere().radius),this._transformControlTx.visible=!1,this._viewer.impl.addOverlay("TranslateToolOverlay",this._transformControlTx),this._transformMesh=this.createTransformMesh(),this._transformControlTx.attach(this._transformMesh),this._viewer.addEventListener(Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,this.onAggregateSelectionChanged),this.emit("activate")}}deactivate(){this.active&&(this.active=!1,this._viewer.toolController.deactivateTool(this.getName()),this._viewer.impl.removeOverlay("TranslateToolOverlay",this._transformControlTx),this._transformControlTx.removeEventListener("change",this.onTxChange),this._viewer.impl.removeOverlayScene("TranslateToolOverlay"),this._viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged),this._viewer.removeEventListener(Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,this.onAggregateSelectionChanged),this.emit("deactivate"))}onPick(){this.active&&(this._selectionMode="SELECTION_MODE_PICK")}handleButtonDown(e,t){if(this._isDragging=!0,this.pointerDown=this._transformControlTx.onPointerDown(e),this.pointerDown&&this._selection)return!0;var i=this.getHitPoint(e);return i&&this._hitPoint.copy(i),!1}handleButtonUp(e){return this._isDragging=!1,!!this._transformControlTx.onPointerUp(e)}handleMouseMove(e){return this._isDragging?!!this._transformControlTx.onPointerMove(e):!!this._transformControlTx.onPointerHover(e)}handleKeyDown(e,t){return 27===t&&(this._viewer.clearSelection(),this.deactivate()),!1}}var s=i(54800);class a extends o.Z{constructor(e){super(),this.keys={},this.active=!1,this.viewer=e,this.fullTransform=!1,this.viewer.toolController.registerTool(this),this.onAggregateSelectionChangedHandler=e=>{this.onAggregateSelectionChanged(e)}}getNames(){return["Viewing.Tool.Rotate"]}getName(){return"Viewing.Tool.Rotate"}setFullTransform(e){this.fullTransform=e,this.clearSelection()}activate(){this.active||(this.active=!0,this.viewer.toolController.activateTool(this.getName()),this.viewer.addEventListener(Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,this.onAggregateSelectionChangedHandler),this.emit("activate"))}deactivate(){this.active&&(this.active=!1,this.viewer.toolController.deactivateTool(this.getName()),this.rotateControl&&(this.rotateControl.remove(),this.rotateControl=null),this.viewer.removeEventListener(Autodesk.Viewing.AGGREGATE_SELECTION_CHANGED_EVENT,this.onAggregateSelectionChangedHandler),this.emit("deactivate"))}onAggregateSelectionChanged(e){if(this.rotateControl&&this.rotateControl.engaged)return this.rotateControl.engaged=!1,void this.viewer.select(this.selection.dbIdArray);if(e.selections.length){var t=e.selections[0];if(this.selection=t,this.fullTransform){this.selection.fragIdsArray=[];for(var i=t.model.getFragmentList().fragments.fragId2dbId.length,o=0;o<i;++o)this.selection.fragIdsArray.push(o);this.selection.dbIdArray=[];var r=t.model.getData().instanceTree.getRootId();this.selection.dbIdArray.push(r)}this.drawControl(),this.viewer.fitToView(this.selection.dbIdArray),this.emit("selection",t)}else this.clearSelection()}clearSelection(){this.selection=null,this.rotateControl&&(this.rotateControl.remove(),this.rotateControl=null,this.viewer.impl.sceneUpdated(!0)),this.emit("selection",null)}drawControl(){var e=this.getWorldBoundingBox(this.selection.fragIdsArray,this.selection.model.getFragmentList());this.center=new THREE.Vector3((e.min.x+e.max.x)/2,(e.min.y+e.max.y)/2,(e.min.z+e.max.z)/2);var t=.8*Math.max(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z);this.rotateControl&&this.rotateControl.remove(),this.rotateControl=new l(this.viewer,this.center,t),this.rotateControl.on("rotate",(e=>{this.rotateFragments(this.selection.model,this.selection.fragIdsArray,e.axis,e.angle,this.center),console.log(this.center),this.viewer.impl.sceneUpdated(!0)}))}handleButtonDown(e,t){return!(!this.rotateControl||!this.rotateControl.onPointerDown(e))||!(0!==t||!this.keys.Control)&&(this.isDragging=!0,this.mousePos={x:e.clientX,y:e.clientY},!0)}handleButtonUp(e,t){return this.rotateControl&&this.rotateControl.onPointerUp(e),0===t&&(this.isDragging=!1),!1}handleMouseMove(e){if(this.rotateControl&&this.rotateControl.onPointerHover(e),this.isDragging){if(this.selection){var t={x:this.mousePos.x-e.clientX,y:e.clientY-this.mousePos.y};this.mousePos={x:e.clientX,y:e.clientY};var i=Math.sqrt(t.x*t.x+t.y*t.y),o=new THREE.Vector3,r=new THREE.Vector3,n=new THREE.Vector3,s=new THREE.Vector3,a=this.viewer.getCamera(),l=new THREE.Vector3,c=new THREE.Vector3;c.copy(a.position).sub(a.target),n.copy(c).normalize(),s.copy(a.up).normalize(),o.crossVectors(s,n).normalize(),s.setLength(t.y),o.setLength(t.x),r.copy(s.add(o)),l.crossVectors(r,c).normalize(),this.rotateFragments(this.selection.model,this.selection.fragIdsArray,l,i*Math.PI/180,this.center),this.viewer.impl.sceneUpdated(!0)}return!0}return!1}handleKeyDown(e,t){return this.keys[e.key]=!0,27===t&&this.deactivate(),!1}handleKeyUp(e,t){return this.keys[e.key]=!1,!1}rotateFragments(e,t,i,o,r){var n=new THREE.Quaternion;n.setFromAxisAngle(i,o),t.forEach(((i,o)=>{var s=this.viewer.impl.getFragmentProxy(e,i);s.getAnimTransform();var a=new THREE.Vector3(s.position.x-r.x,s.position.y-r.y,s.position.z-r.z);if(a.applyQuaternion(n),a.add(r),s.position=a,s.quaternion.multiplyQuaternions(n,s.quaternion),0===o){var l=new THREE.Euler;l.setFromQuaternion(s.quaternion,0),this.emit("rotate",{dbIds:this.selection.dbIdArray,fragIds:t,rotation:l,model:e})}s.updateAnimTransform()}))}getWorldBoundingBox(e,t){var i=new THREE.Box3,o=new THREE.Box3;return e.forEach((e=>{t.getWorldBounds(e,i),o.union(i)})),o}}class l extends o.Z{constructor(e,t,i){super(),this.engaged=!1,this.overlayScene="rotateControlScene",this.domElement=e.impl.canvas,this.camera=e.impl.camera,this.viewer=e,this.center=t,this.size=i,this.gizmos=[],this.viewer.impl.createOverlayScene(this.overlayScene),this.createAxis(t,new THREE.Vector3(1,0,0),.85*i,16711680),this.createAxis(t,new THREE.Vector3(0,1,0),.85*i,65280),this.createAxis(t,new THREE.Vector3(0,0,1),.85*i,255),this.camera.worldup.y?(this.gizmos.push(this.createGizmo(t,new THREE.Euler(0,Math.PI/2,0),.0045*i,.8*i,16711680,Math.PI,new THREE.Vector3(1,0,0))),this.gizmos.push(this.createGizmo(t,new THREE.Euler(Math.PI/2,0,0),.0045*i,.8*i,65280,2*Math.PI,new THREE.Vector3(0,1,0))),this.gizmos.push(this.createGizmo(t,new THREE.Euler(0,0,0),.0045*i,.8*i,255,Math.PI,new THREE.Vector3(0,0,1)))):(this.gizmos.push(this.createGizmo(t,new THREE.Euler(Math.PI/2,Math.PI/2,0),.0045*i,.8*i,16711680,Math.PI,new THREE.Vector3(1,0,0))),this.gizmos.push(this.createGizmo(t,new THREE.Euler(Math.PI/2,0,0),.0045*i,.8*i,65280,Math.PI,new THREE.Vector3(0,1,0))),this.gizmos.push(this.createGizmo(t,new THREE.Euler(0,0,0),.0045*i,.8*i,255,2*Math.PI,new THREE.Vector3(0,0,1)))),this.picker=this.createSphere(.02*i);var o=new THREE.LineBasicMaterial({color:16776960,linewidth:1,depthTest:!1,depthWrite:!1,transparent:!0});this.angleLine=this.createLine(this.center,this.center,o),e.impl.sceneUpdated(!0)}createLine(e,t,i){var o=new THREE.Geometry;o.vertices.push(new THREE.Vector3(e.x,e.y,e.z)),o.vertices.push(new THREE.Vector3(t.x,t.y,t.z));var r=new THREE.Line(o,i);return this.viewer.impl.addOverlay(this.overlayScene,r),r}createCone(e,t,i,o){t.normalize();var r={x:e.x+t.x*i,y:e.y+t.y*i,z:e.z+t.z*i},n=new THREE.Matrix4;n.lookAt(e,r,(new THREE.Object3D).up);var s=new THREE.Matrix4;s.set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),n.multiply(s);var a=new THREE.CylinderGeometry(0,.2*i,i,128,1),l=new THREE.Mesh(a,o);return l.applyMatrix(n),l.position.x=e.x+t.x*i/2,l.position.y=e.y+t.y*i/2,l.position.z=e.z+t.z*i/2,this.viewer.impl.addOverlay(this.overlayScene,l),l}createAxis(e,t,i,o){var r={x:e.x+t.x*i,y:e.y+t.y*i,z:e.z+t.z*i},n=new THREE.LineBasicMaterial({color:o,linewidth:3,depthTest:!1,depthWrite:!1,transparent:!0});this.createLine(e,r,n),this.createCone(r,t,.1*i,n)}createGizmo(e,t,i,o,r,n,s){var a=new c({color:r}),l=new c({color:r}),h=new THREE.Mesh(new THREE.TorusGeometry(o,i,64,64,n),a),d=new THREE.Mesh(new THREE.TorusGeometry(o,i,64,64,2*Math.PI),l);d.material.highlight(!0);var p=new THREE.Matrix4,E=new THREE.Quaternion;E.setFromEuler(t);var u=new THREE.Vector3(1,1,1);p.compose(e,E,u),h.applyMatrix(p),d.applyMatrix(p);var m=this.createBox(100*this.size,100*this.size,.01);return m.applyMatrix(p),d.visible=!1,this.viewer.impl.addOverlay(this.overlayScene,h),this.viewer.impl.addOverlay(this.overlayScene,d),h.subGizmo=d,h.plane=m,h.axis=s,h}createBox(e,t,i){var o=new c({color:0}),r=new THREE.BoxGeometry(e,t,i),n=new THREE.Mesh(r,o);return n.visible=!1,this.viewer.impl.addOverlay(this.overlayScene,n),n}createSphere(e){var t=new c({color:16776960}),i=new THREE.SphereGeometry(e,32,32),o=new THREE.Mesh(i,t);return o.visible=!1,this.viewer.impl.addOverlay(this.overlayScene,o),o}pointerToRaycaster(e){var t=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Raycaster,r=this.domElement.getBoundingClientRect(),n=(e.clientX-r.left)/r.width*2-1,s=-(e.clientY-r.top)/r.height*2+1;return this.camera.isPerspective?(t.set(n,s,.5),t.unproject(this.camera),o.set(this.camera.position,t.sub(this.camera.position).normalize())):(t.set(n,s,-1),t.unproject(this.camera),i.set(0,0,-1),o.set(t,i.transformDirection(this.camera.matrixWorld))),o}onPointerDown(e){var t=e.pointers?e.pointers[0]:e;if(0===t.button){var i=this.pointerToRaycaster(t).intersectObjects(this.gizmos,!0);i.length?(this.gizmos.forEach((e=>{e.visible=!1})),this.selectedGizmo=i[0].object,this.selectedGizmo.subGizmo.visible=!0,this.picker.position.copy(i[0].point),this.angleLine.geometry.vertices[1].copy(i[0].point),this.lastDir=i[0].point.sub(this.center).normalize(),this.angleLine.geometry.verticesNeedUpdate=!0,this.angleLine.visible=!0,this.picker.visible=!0):this.picker.visible=!1,this.engaged=this.picker.visible,this.viewer.impl.sceneUpdated(!0)}return this.picker.visible}onPointerHover(e){var t,i=e.pointers?e.pointers[0]:e,o=this.pointerToRaycaster(i);if(this.engaged){if((t=o.intersectObjects([this.selectedGizmo.plane],!0)).length){var r=t[0].point.sub(this.center).normalize(),n=new THREE.Vector3;n.crossVectors(this.lastDir,r);var s=Math.sign(n.dot(this.selectedGizmo.axis));this.emit("rotate",{angle:s*r.angleTo(this.lastDir),axis:this.selectedGizmo.axis}),this.lastDir=r;var a=new THREE.Vector3(this.center.x+r.x*this.size*.8,this.center.y+r.y*this.size*.8,this.center.z+r.z*this.size*.8);this.picker.position.copy(a),this.angleLine.geometry.vertices[1].copy(a)}this.angleLine.visible=!0,this.angleLine.geometry.verticesNeedUpdate=!0}else this.angleLine.visible=!1,(t=o.intersectObjects(this.gizmos,!0)).length?(this.picker.position.set(t[0].point.x,t[0].point.y,t[0].point.z),this.picker.visible=!0):this.picker.visible=!1;this.viewer.impl.sceneUpdated(!0)}onPointerUp(e){this.angleLine.visible=!1,this.picker.visible=!1,this.gizmos.forEach((e=>{e.visible=!0,e.subGizmo.visible=!1})),this.viewer.impl.sceneUpdated(!0),setTimeout((()=>{this.engaged=!1}),100)}normalize(e){var t=this.viewer.navigation.getScreenViewport();return{x:(e.x-t.left)/t.width,y:(e.y-t.top)/t.height}}projectOntoPlane(e,t){var i=t.dot(e);return new THREE.Vector3(e.x-i*t.x,e.y-i*t.y,e.z-i*t.z)}remove(){this.viewer.impl.removeOverlayScene(this.overlayScene)}}class c extends THREE.MeshBasicMaterial{constructor(e){super(),this.setValues(e),this.colorInit=this.color.clone(),this.opacityInit=this.opacity,this.side=THREE.FrontSide,this.depthWrite=!1,this.transparent=!0,this.depthTest=!1}highlight(e){e?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.colorInit),this.opacity=this.opacityInit)}}var h=i(31430),d=i.n(h);class p extends s.Z{constructor(e,t={}){super(e,t),this.translateTool=new n(e),this.rotateTool=new a(e),this.transformedFragIdMap={},this.translateTool.on("selection",(e=>{const t=e?Object.assign({},e,{type:"translate"}):null;this.emit("selection",t)})),this.translateTool.on("translate",(e=>{e.fragIds.forEach((e=>{this.transformedFragIdMap[e]=!0})),this.emit("transform",{transform:{translation:e.translation},fragIds:e.fragIds,model:e.model,dbIds:e.dbIds})})),this.translateTool.on("deactivate",(()=>{this._txControl.container.classList.remove("active"),this._comboCtrl.container.classList.remove("active"),this.emit("deactivate")})),this.rotateTool.on("selection",(e=>{const t=e?Object.assign({},e,{type:"rotate"}):null;this.emit("selection",t)})),this.rotateTool.on("rotate",(e=>{e.fragIds.forEach((e=>{this.transformedFragIdMap[e]=!0})),this.emit("transform",{transform:{rotation:e.rotation},fragIds:e.fragIds,model:e.model,dbIds:e.dbIds})})),this.rotateTool.on("deactivate",(()=>{this._rxControl.container.classList.remove("active"),this._comboCtrl.container.classList.remove("active"),this.emit("deactivate")})),this.btnClickEvts=[]}static get ExtensionId(){return"VE.Transform"}load(){return console.log("viewing.Extension.Transform loaded"),this.btnClickEvts.push({key:"translate.move",fun:this.moveBtnClick.bind(this)}),this.btnClickEvts.push({key:"translate.rotate",fun:this.rotateBtnClick.bind(this)}),!0}moveBtnClick(){this.translateTool.active?(this.translateTool.deactivate(),this._txControl.container.classList.remove("active"),this._comboCtrl.container.classList.remove("active")):this.translate()}rotateBtnClick(){this.rotateTool.active?(this.rotateTool.deactivate(),this._rxControl.container.classList.remove("active"),this._comboCtrl.container.classList.remove("active")):this.rotate()}onToolbarCreated(){i(58685),this._txControl=r.Z.createButton("toolbar-translate","translate-move","",(()=>{this.moveBtnClick()})),this._txControl.icon.innerHTML=this.createMoveIcon(),this._rxControl=r.Z.createButton("toolbar-rotate","translate-rotate","",(()=>{this.rotateBtnClick()})),this._rxControl.icon.innerHTML=this.createRotationIcon(),this.parentControl=this._options.parentControl;var e=this._viewer.getToolbar(!0);if("string"==typeof this.parentControl&&(this.parentControl=e.getControl(this.parentControl)),!this.parentControl&&!this._options.hideControls){var t="wdkitsTools-1";this.parentControl=e.getControl(t)?e.getControl(t):new Autodesk.Viewing.UI.ControlGroup(t),e.addControl(this.parentControl)}this._comboCtrl=new Autodesk.Viewing.UI.ComboButton("toolbar-transform"),this._comboCtrl.setToolTip(""),this._comboCtrl.icon.style.fontSize="24px",this._comboCtrl.icon.style.transform="rotateY(180Deg)",this._comboCtrl.icon.innerHTML=this.createBtnGroupIcon(),this._comboCtrl.icon.className="glyphicon glyphicon-wrench",this._comboCtrl.addControl(this._txControl),this._comboCtrl.addControl(this._rxControl);var o=this._comboCtrl.onClick;this._comboCtrl.onClick=()=>{this._comboCtrl.container.classList.contains("active")?this.deactivate():o()},this._options.hideControls||this.parentControl.addControl(this._comboCtrl)}unload(){this.parentControl.removeControl(this._comboCtrl),this.translateTool.deactivate(),this.rotateTool.deactivate(),console.log("viewing.Extension.Transform unloaded")}createMoveIcon(){return["<div class='wedofont wedo-viewer-move'></div>"].join("")}createRotationIcon(){return["<div class='wedofont wedo-viewer-rotation'></div>"].join("")}createBtnGroupIcon(){return'\n        <span class="wedofont wedo-bianhuan" style="font-size: 24px !important;"></span>        \n        '}translate(){this.translateTool.activate(),this._txControl.container.classList.add("active"),this.rotateTool.deactivate(),this._rxControl.container.classList.remove("active"),this._comboCtrl.container.classList.add("active")}rotate(){this.rotateTool.activate(),this._rxControl.container.classList.add("active"),this.translateTool.deactivate(),this._txControl.container.classList.remove("active"),this._comboCtrl.container.classList.add("active")}deactivate(){this._txControl.container.classList.remove("active"),this._rxControl.container.classList.remove("active"),this._comboCtrl.container.classList.remove("active"),this.translateTool.deactivate(),this.rotateTool.deactivate()}setFullTransform(e){this.translateTool.setFullTransform(e),this.rotateTool.setFullTransform(e)}pickPosition(){this.translateTool.onPick()}clearSelection(){this.translateTool.clearSelection(),this.rotateTool.clearSelection()}getState(e){this.currentExplodeScale=this.currentExplodeScale||this._viewer.getExplodeScale(),e.explodeScale=this.currentExplodeScale,e.transforms={};for(const t in this.transformedFragIdMap){const i=this._viewer.impl.getFragmentProxy(this._viewer.model,t);i.getAnimTransform(),e.transforms[t]={quaternion:i.quaternion,position:i.position}}}restoreState(e,t){if(this.translateTool.clearSelection(),this.rotateTool.clearSelection(),e.transforms){const t=1.8,i=e=>d().easeInOutExpo(e,0,1,.7*t);this.animateTransform(e,i,t).then((()=>{this.currentExplodeScale=e.explodeScale})),this.transformedFragIdMap=Object.assign({},e.transforms),this.viewer.impl.sceneUpdated(!0)}}restoreTransform(e){[...Object.keys(this.transformedFragIdMap),...Object.keys(e.transforms)].forEach((t=>{const i=e.transforms[t]||{quaternion:{_x:0,_y:0,_z:0,_w:1},position:{x:0,y:0,z:0}},o=viewer.impl.getFragmentProxy(this._viewer.model,t);o.getAnimTransform(),o.position.x=i.position.x,o.position.y=i.position.y,o.position.z=i.position.z,o.quaternion._x=i.quaternion._x,o.quaternion._y=i.quaternion._y,o.quaternion._z=i.quaternion._z,o.quaternion._w=i.quaternion._w,o.updateAnimTransform()}))}animateTransform(e,t,i=2){return new Promise((async(o,n)=>{const s=this._viewer,a=[...Object.keys(this.transformedFragIdMap),...Object.keys(e.transforms)],l=a.map((t=>{const o=s.impl.getFragmentProxy(s.model,t);o.getAnimTransform();const r=e.transforms[t]||{quaternion:{_x:0,_y:0,_z:0,_w:1},position:{x:0,y:0,z:0}};return o.step={dx:(r.position.x-o.position.x)/i,dy:(r.position.y-o.position.y)/i,dz:(r.position.z-o.position.z)/i,dQx:(r.quaternion._x-o.quaternion._x)/i,dQy:(r.quaternion._y-o.quaternion._y)/i,dQz:(r.quaternion._z-o.quaternion._z)/i,dQw:(r.quaternion._w-o.quaternion._w)/i},o.initialTransform={quaternion:{_x:o.quaternion._x,_y:o.quaternion._y,_z:o.quaternion._z,_w:o.quaternion._w},position:{x:o.position.x,y:o.position.y,z:o.position.z}},o.targetTransform=r,o})),c=(await Promise.all(l)).map((e=>({step:t=>{e.quaternion._x+=e.step.dQx*t,e.quaternion._y+=e.step.dQy*t,e.quaternion._z+=e.step.dQz*t,e.quaternion._w+=e.step.dQw*t,e.position.x+=e.step.dx*t,e.position.y+=e.step.dy*t,e.position.z+=e.step.dz*t,e.updateAnimTransform()},ease:o=>{const r=t(o/i),n=e.targetTransform.quaternion,s=e.initialTransform.quaternion,a=new THREE.Quaternion(s._x,s._y,s._z,s._w),l=new THREE.Quaternion(n._x,n._y,n._z,n._w);a.slerp(l,r),e.quaternion._x=a.x,e.quaternion._y=a.y,e.quaternion._z=a.z,e.quaternion._w=a.w;const c=e.targetTransform.position,h=e.initialTransform.position;e.position.x=r*c.x+(1-r)*h.x,e.position.y=r*c.y+(1-r)*h.y,e.position.z=r*c.z+(1-r)*h.z,e.updateAnimTransform()},finalStep:()=>{e.quaternion._x=e.targetTransform.quaternion._x,e.quaternion._y=e.targetTransform.quaternion._y,e.quaternion._z=e.targetTransform.quaternion._z,e.quaternion._w=e.targetTransform.quaternion._w,e.position.copy(e.targetTransform.position),e.updateAnimTransform()}})));let h=parseFloat(this.currentExplodeScale);const d=parseFloat(e.explodeScale);if(d!=h){var p=(d-h)/i;c.push({step:e=>{h+=p*e,r.Z.selectiveExplode(s,h,a)},ease:e=>{const o=t(e/i),n=h+o*(d-h);r.Z.selectiveExplode(s,n,a)},finalStep:()=>{r.Z.selectiveExplode(s,d,a),s.explodeSlider.value=d}})}let E=0,u=0;const m=new class{constructor(){this._lastTime=performance.now()}start(){this._lastTime=performance.now()}getElapsedMs(){var e=performance.now(),t=e-this._lastTime;return this._lastTime=e,t}},v=()=>{const e=.001*m.getElapsedMs();u+=e,u<i?(c.forEach((e=>{e.ease(u)})),E=requestAnimationFrame(v)):(c.forEach((e=>{e.finalStep()})),cancelAnimationFrame(E),s.autocam.shotParams.duration=1),s.impl.sceneUpdated(!0),o()};s.autocam.shotParams.duration=i,E=requestAnimationFrame(v)}))}}Autodesk.Viewing.theExtensionManager.registerExtension(p.ExtensionId,p)},58685:(e,t,i)=>{var o=i(93379),r=i(52655);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.id,r,""]]);var n=o(r,{insert:"head",singleton:!1});if(!r.locals||e.hot.invalidate){var s=r.locals;e.hot.accept(52655,(function(){"string"==typeof(r=(r=i(52655)).__esModule?r.default:r)&&(r=[[e.id,r,""]]),function(e,t){if(!e&&t||e&&!t)return!1;var i;for(i in e)if(e[i]!==t[i])return!1;for(i in t)if(!e[i])return!1;return!0}(s,r.locals)?(s=r.locals,n(r)):e.hot.invalidate()}))}e.hot.dispose((function(){n()})),e.exports=r.locals||{}}},r={};function n(e){var t=r[e];if(void 0!==t){if(void 0!==t.error)throw t.error;return t.exports}var i=r[e]={id:e,loaded:!1,exports:{}};try{var s={id:e,module:i,factory:o[e],require:n};n.i.forEach((function(e){e(s)})),i=s.module,s.factory.call(i.exports,i,i.exports,s.require)}catch(e){throw i.error=e,e}return i.loaded=!0,i.exports}n.m=o,n.c=r,n.i=[],e=[],n.O=(t,i,o,r)=>{if(!i){var s=1/0;for(c=0;c<e.length;c++){for(var[i,o,r]=e[c],a=!0,l=0;l<i.length;l++)(!1&r||s>=r)&&Object.keys(n.O).every((e=>n.O[e](i[l])))?i.splice(l--,1):(a=!1,r<s&&(s=r));a&&(e.splice(c--,1),t=o())}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[i,o,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.hu=e=>e+"."+n.h()+".hot-update.js",n.hmrF=()=>"Transform."+n.h()+".hot-update.json",n.h=()=>"7152d5a9c66f2a2ebb99",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},i="wd-viewer:",n.l=(e,o,r,s)=>{if(t[e])t[e].push(o);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var d=c[h];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+r){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",i+r),a.src=e),t[e]=[o];var p=(i,o)=>{a.onerror=a.onload=null,clearTimeout(E);var r=t[e];if(delete t[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(o))),i)return i(o)},E=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.j=240,(()=>{var e,t,i,o,r={},s=n.c,a=[],l=[],c="idle";function h(e){c=e;for(var t=0;t<l.length;t++)l[t].call(null,e)}function d(e){if(0===t.length)return e();var i=t;return t=[],Promise.all(i).then((function(){return d(e)}))}function p(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return h("check"),n.hmrM().then((function(o){if(!o)return h(m()?"ready":"idle"),null;h("prepare");var r=[];return t=[],i=[],Promise.all(Object.keys(n.hmrC).reduce((function(e,t){return n.hmrC[t](o.c,o.r,o.m,e,i,r),e}),[])).then((function(){return d((function(){return e?u(e):(h("ready"),r)}))}))}))}function E(e){return"ready"!==c?Promise.resolve().then((function(){throw new Error("apply() is only allowed in ready status")})):u(e)}function u(e){e=e||{},m();var t=i.map((function(t){return t(e)}));i=void 0;var r,n=t.map((function(e){return e.error})).filter(Boolean);if(n.length>0)return h("abort"),Promise.resolve().then((function(){throw n[0]}));h("dispose"),t.forEach((function(e){e.dispose&&e.dispose()})),h("apply");var s=function(e){r||(r=e)},a=[];return t.forEach((function(e){if(e.apply){var t=e.apply(s);if(t)for(var i=0;i<t.length;i++)a.push(t[i])}})),r?(h("fail"),Promise.resolve().then((function(){throw r}))):o?u(e).then((function(e){return a.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e})):(h("idle"),Promise.resolve(a))}function m(){if(o)return i||(i=[]),Object.keys(n.hmrI).forEach((function(e){o.forEach((function(t){n.hmrI[e](t,i)}))})),o=void 0,!0}n.hmrD=r,n.i.push((function(u){var m,v,f,y,T=u.module,w=function(i,o){var r=s[o];if(!r)return i;var n=function(t){if(r.hot.active){if(s[t]){var n=s[t].parents;-1===n.indexOf(o)&&n.push(o)}else a=[o],e=t;-1===r.children.indexOf(t)&&r.children.push(t)}else console.warn("[HMR] unexpected require("+t+") from disposed module "+o),a=[];return i(t)},l=function(e){return{configurable:!0,enumerable:!0,get:function(){return i[e]},set:function(t){i[e]=t}}};for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&"e"!==p&&Object.defineProperty(n,p,l(p));return n.e=function(e){return function(e){switch(c){case"ready":return h("prepare"),t.push(e),d((function(){h("ready")})),e;case"prepare":return t.push(e),e;default:return e}}(i.e(e))},n}(u.require,u.id);T.hot=(m=u.id,v=T,y={_acceptedDependencies:{},_acceptedErrorHandlers:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:f=e!==m,_requireSelf:function(){a=v.parents.slice(),e=f?void 0:m,n(m)},active:!0,accept:function(e,t,i){if(void 0===e)y._selfAccepted=!0;else if("function"==typeof e)y._selfAccepted=e;else if("object"==typeof e&&null!==e)for(var o=0;o<e.length;o++)y._acceptedDependencies[e[o]]=t||function(){},y._acceptedErrorHandlers[e[o]]=i;else y._acceptedDependencies[e]=t||function(){},y._acceptedErrorHandlers[e]=i},decline:function(e){if(void 0===e)y._selfDeclined=!0;else if("object"==typeof e&&null!==e)for(var t=0;t<e.length;t++)y._declinedDependencies[e[t]]=!0;else y._declinedDependencies[e]=!0},dispose:function(e){y._disposeHandlers.push(e)},addDisposeHandler:function(e){y._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=y._disposeHandlers.indexOf(e);t>=0&&y._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":i=[],Object.keys(n.hmrI).forEach((function(e){n.hmrI[e](m,i)})),h("ready");break;case"ready":Object.keys(n.hmrI).forEach((function(e){n.hmrI[e](m,i)}));break;case"prepare":case"check":case"dispose":case"apply":(o=o||[]).push(m)}},check:p,apply:E,status:function(e){if(!e)return c;l.push(e)},addStatusHandler:function(e){l.push(e)},removeStatusHandler:function(e){var t=l.indexOf(e);t>=0&&l.splice(t,1)},data:r[m]},e=void 0,y),T.parents=a,T.children=[],a=[],u.require=w})),n.hmrC={},n.hmrI={}})(),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e,t,i,o,r={240:0},s={};function a(e){return new Promise(((t,i)=>{s[e]=t;var o=n.p+n.hu(e),r=new Error;n.l(o,(t=>{if(s[e]){s[e]=void 0;var o=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;r.message="Loading hot update chunk "+e+" failed.\n("+o+": "+n+")",r.name="ChunkLoadError",r.type=o,r.request=n,i(r)}}))}))}function l(s){function a(e){for(var t=[e],i={},o=t.map((function(e){return{chain:[e],id:e}}));o.length>0;){var r=o.pop(),s=r.id,a=r.chain,c=n.c[s];if(c&&(!c.hot._selfAccepted||c.hot._selfInvalidated)){if(c.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:s};if(c.hot._main)return{type:"unaccepted",chain:a,moduleId:s};for(var h=0;h<c.parents.length;h++){var d=c.parents[h],p=n.c[d];if(p){if(p.hot._declinedDependencies[s])return{type:"declined",chain:a.concat([d]),moduleId:s,parentId:d};-1===t.indexOf(d)&&(p.hot._acceptedDependencies[s]?(i[d]||(i[d]=[]),l(i[d],[s])):(delete i[d],t.push(d),o.push({chain:a.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}function l(e,t){for(var i=0;i<t.length;i++){var o=t[i];-1===e.indexOf(o)&&e.push(o)}}n.f&&delete n.f.jsonpHmr,e=void 0;var c={},h=[],d={},p=function(e){console.warn("[HMR] unexpected require("+e.id+") to disposed module")};for(var E in t)if(n.o(t,E)){var u,m=t[E],v=!1,f=!1,y=!1,T="";switch((u=m?a(E):{type:"disposed",moduleId:E}).chain&&(T="\nUpdate propagation: "+u.chain.join(" -> ")),u.type){case"self-declined":s.onDeclined&&s.onDeclined(u),s.ignoreDeclined||(v=new Error("Aborted because of self decline: "+u.moduleId+T));break;case"declined":s.onDeclined&&s.onDeclined(u),s.ignoreDeclined||(v=new Error("Aborted because of declined dependency: "+u.moduleId+" in "+u.parentId+T));break;case"unaccepted":s.onUnaccepted&&s.onUnaccepted(u),s.ignoreUnaccepted||(v=new Error("Aborted because "+E+" is not accepted"+T));break;case"accepted":s.onAccepted&&s.onAccepted(u),f=!0;break;case"disposed":s.onDisposed&&s.onDisposed(u),y=!0;break;default:throw new Error("Unexception type "+u.type)}if(v)return{error:v};if(f)for(E in d[E]=m,l(h,u.outdatedModules),u.outdatedDependencies)n.o(u.outdatedDependencies,E)&&(c[E]||(c[E]=[]),l(c[E],u.outdatedDependencies[E]));y&&(l(h,[u.moduleId]),d[E]=p)}t=void 0;for(var w,g=[],R=0;R<h.length;R++){var x=h[R],M=n.c[x];M&&(M.hot._selfAccepted||M.hot._main)&&d[x]!==p&&!M.hot._selfInvalidated&&g.push({module:x,require:M.hot._requireSelf,errorHandler:M.hot._selfAccepted})}return{dispose:function(){var e;i.forEach((function(e){delete r[e]})),i=void 0;for(var t,o=h.slice();o.length>0;){var s=o.pop(),a=n.c[s];if(a){var l={},d=a.hot._disposeHandlers;for(R=0;R<d.length;R++)d[R].call(null,l);for(n.hmrD[s]=l,a.hot.active=!1,delete n.c[s],delete c[s],R=0;R<a.children.length;R++){var p=n.c[a.children[R]];p&&(e=p.parents.indexOf(s))>=0&&p.parents.splice(e,1)}}}for(var E in c)if(n.o(c,E)&&(a=n.c[E]))for(w=c[E],R=0;R<w.length;R++)t=w[R],(e=a.children.indexOf(t))>=0&&a.children.splice(e,1)},apply:function(e){for(var t in d)n.o(d,t)&&(n.m[t]=d[t]);for(var i=0;i<o.length;i++)o[i](n);for(var r in c)if(n.o(c,r)){var a=n.c[r];if(a){w=c[r];for(var l=[],p=[],E=[],u=0;u<w.length;u++){var m=w[u],v=a.hot._acceptedDependencies[m],f=a.hot._acceptedErrorHandlers[m];if(v){if(-1!==l.indexOf(v))continue;l.push(v),p.push(f),E.push(m)}}for(var y=0;y<l.length;y++)try{l[y].call(null,w)}catch(t){if("function"==typeof p[y])try{p[y](t,{moduleId:r,dependencyId:E[y]})}catch(i){s.onErrored&&s.onErrored({type:"accept-error-handler-errored",moduleId:r,dependencyId:E[y],error:i,originalError:t}),s.ignoreErrored||(e(i),e(t))}else s.onErrored&&s.onErrored({type:"accept-errored",moduleId:r,dependencyId:E[y],error:t}),s.ignoreErrored||e(t)}}}for(var T=0;T<g.length;T++){var R=g[T],x=R.module;try{R.require(x)}catch(t){if("function"==typeof R.errorHandler)try{R.errorHandler(t,{moduleId:x,module:n.c[x]})}catch(i){s.onErrored&&s.onErrored({type:"self-accept-error-handler-errored",moduleId:x,error:i,originalError:t}),s.ignoreErrored||(e(i),e(t))}else s.onErrored&&s.onErrored({type:"self-accept-errored",moduleId:x,error:t}),s.ignoreErrored||e(t)}}return h}}}self.webpackHotUpdatewd_viewer=(e,i,r)=>{for(var a in i)n.o(i,a)&&(t[a]=i[a]);r&&o.push(r),s[e]&&(s[e](),s[e]=void 0)},n.hmrI.jsonp=function(e,r){t||(t={},o=[],i=[],r.push(l)),n.o(t,e)||(t[e]=n.m[e])},n.hmrC.jsonp=function(s,c,h,d,p,E){p.push(l),e={},i=c,t=h.reduce((function(e,t){return e[t]=!1,e}),{}),o=[],s.forEach((function(t){n.o(r,t)&&void 0!==r[t]&&(d.push(a(t)),e[t]=!0)})),n.f&&(n.f.jsonpHmr=function(t,i){e&&!n.o(e,t)&&n.o(r,t)&&void 0!==r[t]&&(i.push(a(t)),e[t]=!0)})},n.hmrM=()=>{if("undefined"==typeof fetch)throw new Error("No browser support: need fetch API");return fetch(n.p+n.hmrF()).then((e=>{if(404!==e.status){if(!e.ok)throw new Error("Failed to fetch update manifest "+e.statusText);return e.json()}}))},n.O.j=e=>0===r[e];var c=(e,t)=>{var i,o,[s,a,l]=t,c=0;for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)var h=l(n);for(e&&e(t);c<s.length;c++)o=s[c],n.o(r,o)&&r[o]&&r[o][0](),r[s[c]]=0;return n.O(h)},h=self.webpackChunkwd_viewer=self.webpackChunkwd_viewer||[];h.forEach(c.bind(null,0)),h.push=c.bind(null,h.push.bind(h))})();var s=n.O(void 0,[839],(()=>n(7892)));return n.O(s)})()}));